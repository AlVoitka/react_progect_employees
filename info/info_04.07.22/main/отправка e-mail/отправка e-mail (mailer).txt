1 курс урок 63

AJAX - технология по взаимодействию с сервером без перезагрузки страницы.
Отправка и получение данных по протоколам. В стандартном поведении браузера, при отправке формы страница перезагружается, и в это время 
отправляются  данные на сервер (или приходят с сервера). Но это стандартное поведение можно отменить по средствам AJAX.

 1. В корень папки проекта нужно поместить папку mailer ( она есть впапочке Pligin  у меня). Это и есть плагин по отправке писем.

 2. там папка phpmailer - ее трогать вообще не нужно, там все настроено

 3. базовые настройки плагина:
 создаю mailer.js  и подключаю его в script.js
 в нем:

 - обращаюсь ко всем форма по тэгу 'form':
 (если нужжно к конкретной форме, то можно обратиться по классу или id или data атрибуту).
 Двлее все формы сабмитятся те подтверждаются ( пройдены все валидации). И после того как 
 формы засабмителись я выполняю действие (те прописываю функцию) и передею в нее аргумент e (event) - событие.
 и отменяю стандартное поведение браузера e.preventDefault() ( те форма не отправляется и страница не перезагружается)

  $('form').submit(function() {
        e.preventDefault();
  }

Прописываю условия по валидации:
если эта форма не прошла валидацию, то в таком случае эта функция просто прекращается:
и код не дайдет до отправки запроса на smart.php
Таким образом если форма не заполнена, то пустые данные не отправятся.

if(!$(this).valid()) {
          return;
        }


  далее мне нужно отправить данные на сервер при помощи методвыа ajax который есть внутри jQuery:

$('form').submit(function() {
        e.preventDefault();
        $.ajax({})  - внутри открываю объект 
  }

  настраиваю этот объект:

type: "POST",  -- говорю что буду отправлять данные, а не получать
url: "mailer/smart.php",  --- говорю куда отправляю запрос
data: $(this).serialize()    --- данные которые я буду отправлять



$.ajax({
    type: "POST",
    url: "mailer/smart.php",
    data: $(this).serialize()
})
 далее я говорю что когда операция будет выполнени .done() то будет выполнятся следующее действие function():

.done(function() {
    $(this).finde("input").val("");  --- говорю что внутри этой формы $(this), нахожу инпуты .finde("input") 
                                          и устанавливаю им значение .val() - пустая строка .val("")


Так же мне нужно чтобы все мои формы после отправки обновились (очистились):

$('form').trigger('reset');
});

И в конце:

return false;



///////------ В smart.php ----------/////////////

1. Важно в HTML импутам назначать атрибут name !!!!
Вот сейчас с ним у буду работать:

$name = $_POST['name'];  --- тут написано что я беру импут у которого есть атрибут name="name" и помещаю значение в переменную
$phone = $_POST['phone'];
$email = $_POST['email'];

2. Настройка SMTP
SMTP (англ. Simple Mail Transfer Protocol — простой протокол передачи почты)
 — это широко используемый сетевой протокол, предназначенный для передачи электронной почты в сетях TCP/IP.


$mail->isSMTP();                                      // Set mailer to use SMTP
$mail->Host = 'smtp.gmail.com';  //  установливая smtp сервер. для кождой почты smtp разный нужно смотреть
$mail->SMTPAuth = true;                               // разрешаю вход в заданную почту
$mail->Username = '';                 // Наш логин
$mail->Password = '';                           // Наш пароль от ящика Нужно использовать пароль для приложений ()
$mail->SMTPSecure = 'ssl';                            // Enable TLS encryption, `ssl` also accepted
$mail->Port = 465;                                    // TCP port to connect to
 
$mail->setFrom('', 'Pulse');   // От кого письмо 
$mail->addAddress('');     // Add a recipient
//$mail->addAddress('ellen@example.com');               // Name is optional
//$mail->addReplyTo('info@example.com', 'Information');
//$mail->addCC('cc@example.com');
//$mail->addBCC('bcc@example.com');
//$mail->addAttachment('/var/tmp/file.tar.gz');         // Add attachments
//$mail->addAttachment('/tmp/image.jpg', 'new.jpg');    // Optional name
$mail->isHTML(true);                                  // Set email format to HTML

$mail->Subject = 'Данные';
$mail->Body    = '
		Пользователь оставил данные <br> 
	Имя: ' . $name . ' <br>
	Номер телефона: ' . $phone . '<br>
	E-mail: ' . $email . '';



Пароль для приложений  для аккаунта v.superalex

Пароль приложения для вашего устройства
lewv aofn onsh uwgb


